# NiuNiuBattle（牛牛大作战）

**面向用户的使用说明（含指令与示例）**：[牛牛大作战 · 使用说明](niuniu_battle_用户说明.md)

## 简介

群聊内以「牛牛长度」为数值的轻量娱乐插件：通过「导」「日」等指令随机增减长度，支持查询与排行榜。**仅群聊**生效；**可用群聊列表为空时默认全部不开放**，由管理员在目标群内发送「开启牛牛大作战」逐群开启。

## 命令（均不带斜杠）

| 触发 | 说明 | 权限 |
|------|------|------|
| 导 | 对自己的牛牛长度进行一次随机变化，当日设了次数 +1 | 群内所有人（仅当本群已开启） |
| 日群友 / 草群友 / 操群友 | 对他人的牛牛长度进行一次变化：单独发送则随机选一人，@ 某人则指定目标；不能 @ 自己 | 同上 |
| 我的牛牛 / 我的牛子 | 查询自己的牛牛长度 | 同上 |
| 查看牛牛@某人 | 查询被 @ 用户的牛牛长度 | 同上 |
| 牛牛排行榜 | 本群长度前十与后十 | 同上 |
| 设置牛牛@某人 键 数值 | 设置该用户在本群的「长度」或「设了次数」 | 管理员 |
| 开启牛牛大作战 | 将当前群加入可用列表 | 管理员 |
| 关闭牛牛大作战 | 将当前群从可用列表移除 | 管理员 |

## 权限与过滤

- **仅群聊**：私聊不响应。
- **可用群聊**：仅当当前群在「可用群聊」列表内时才响应上述指令；列表存于 **NcatBot 插件配置** `data/NiuNiuBattle/NiuNiuBattle.yaml`（配置项 `enabled_group_ids`）。列表为空时默认**全部不开放**。
- **管理员**：需 NcatBot 的 admin/root 权限，用于 设置牛牛、开启/关闭牛牛大作战。

## 配置与数据

- **可用群聊**：插件配置项 `enabled_group_ids`（群 ID 列表），存于 `data/NiuNiuBattle/NiuNiuBattle.yaml`。通过「开启/关闭牛牛大作战」修改并写回；也可用系统命令 `/set_config NiuNiuBattle enabled_group_ids [...]` 或 `/cfg` 修改。参见 [插件配置项](https://docs.ncatbot.xyz/guide/plugin-config/)。
- **持久化**：使用项目 `db` 包，表 `niuniu_user`（群+用户+长度）、`niuniu_daily_count`（群+用户+日期+设了次数）。

## 设计文档

详见 [牛牛大作战 设计草稿](../design/drafts/牛牛大作战.md)。
